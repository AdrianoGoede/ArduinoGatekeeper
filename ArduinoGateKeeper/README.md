# Arduino Gatekeeper
A secure and robust access control system built on a Wi-Fi enabled Arduino board. This project leverages FreeRTOS to manage concurrent tasks, allowing for real-time RFID authentication, network communication, and system logging without blocking operations. The code has been tested and verified on the **Arduino UNO R4 WiFi**.

## Overview
The Arduino Gatekeeper serves as the embedded control unit for a physical access point. It is designed to be reliable and responsive, handling multiple critical functions simultaneously:

* Access Control: Reads RFID cards using the MFRC522 module to grant or deny access.

* Visual Feedback: Provides an immediate response to card reads via a green LED for granted access and a red LED for denied access.

* Real-time Communication: Connects to an MQTT broker to receive updates on authorized users and to send real-time activity logs for remote monitoring and management.

Concurrency: Utilizes the FreeRTOS real-time operating system to separate the hardware access control logic from the networking and logging tasks. This ensures that a slow network connection never prevents the system from reading an RFID card.

### Key Components
MFRC522 RFID Reader: The central component for reading RFID card UIDs. The code interacts with the reader to get card information and halt the card to prevent double-reads.

LEDs:

Green LED: Indicates that a card has been successfully authenticated and access has been granted.

Red LED: Indicates that a card is not recognized and access has been denied.

Wi-Fi Module: Handles the wireless network connection to the MQTT broker and an NTP server.

FreeRTOS: Manages the three main tasks in the system:

Access Control Task: A high-priority task dedicated to polling the RFID reader and handling authentication.

Networking Task: Manages the Wi-Fi and MQTT connections, and handles both incoming messages from the broker and outgoing activity reports.

Logging Task: Processes the log entries generated by the access control task and sends them to the MQTT broker.

## Software Architecture
The software is structured into modular C++ classes to enhance maintainability and code reuse:

AccessControl.h/.cpp: Manages the RFID reader, handles card authentication, and maintains a buffer of activity logs.

Network.h/.cpp: Manages the Wi-Fi, NTP, and MQTT connections. It is responsible for sending activity logs and receiving commands for managing authorized users.

CircularBuffer.h: A generic, memory-safe data structure used for storing messages and log entries. It is a key component for decoupling the tasks and preventing memory fragmentation.

config.h: Centralized location for all system configurations, including network credentials, pin assignments, and MQTT topics.

## Setup and Configuration
Before uploading the code, you must configure the system settings in config.h:

Enter your Wi-Fi SSID and password.

Specify the MQTT broker address and port.

Adjust the pin numbers for the RFID reader and LEDs to match your hardware setup.

## To-Do
* MQTT Encryption and Authentication: Implement support for MQTTS and password authentication to secure the connection to the broker.

* Digital Signatures: Use digital signatures for all incoming and outgoing messages to ensure message integrity and authenticity.

* SD Card Integration: Add support for an SD card to allow for a larger number of authorized users to be stored on the device, rather than only in RAM.


This project is a solid foundation for a highly reliable and scalable embedded system. Feel free to explore the code, open issues, and contribute improvements!
